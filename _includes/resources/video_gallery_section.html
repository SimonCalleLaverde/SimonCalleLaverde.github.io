<section class="video-gallery-section bg-grey-dark clearfix">
  <div class="container">

    {% assign posts_count = 0 %}
    {% assign sorted_videos = site.videos | sort:"order" %}

    {% for video in sorted_videos %}
      {% capture video_id %}{{ video.video.url }}{% endcapture %}
      {% assign escaped_content = video_id | escape %}

      {% if video_id contains "watch" %}
        {% capture "video_id" %}{{ video_id | replace:'watch?v=','embed/' }}{% endcapture %}<!--https://www.youtube.com/watch?v=DPZdqJWxoIY-->
      {% endif %}

      {% if video_id.size > 0 %}
        {% if posts_count == 0 %}
        <div class="row no-gutters">
        {% endif %}
          <div class="col-md-4">
            <article class="{% if posts_count == 0 %}pr-md-2 pl-md-0{% elsif posts_count == 2 %}pr-md-0 pl-md-2{% else %}px-md-2{% endif %} mb-4">
              <div class="preview-video" style="position:relative; width:100%;">
                <a href="{{ video_id }}" data-videomodal-title="{{ child.name }}">
                  <div class="filter">
                  </div>

                  <i class="fa fa-play-circle" aria-hidden="true"></i>
                  
                  <style type="text/css">
                    #thumbnail_{{ video.slug }} {
                      background:url('{{ video.video.image }}') no-repeat center center scroll;
                      -webkit-background-size:cover;
                      -moz-background-size:cover;
                      -o-background-size:cover;
                      background-size:cover;
                    }
                  </style>
                  <div class="video-thumbnail" id="thumbnail_{{ video.slug }}" title="{{ child.name }} Video Thumbnail Image"><!--style="height:190px;"-->
                  </div>
                  
                  {% if escaped_content contains 'https://vimeo.com/' %}<!--and child.features.size == 0-->
                    <script type="text/javascript">
                      $(function(){
                        $.get('http://vimeo.com/api/v2/video/{{ video_id }}.json', function(data){
                          $('#thumbnail_{{ video.slug }}').prop('src',data[0]['thumbnail_large']);
                        });
                      });
                    </script>
                  {% endif %}
                </a>
              </div>

              <h6 class="text-magenta text-center text-uppercase pt-3">{{ video.name }}</h6>
            </article>
          </div>
        {% assign posts_count = posts_count | plus:1 %}
        {% if posts_count == 3 or forloop.last %}
        </div>
        {% assign posts_count = 0 %}
        {% endif %}
      {% endif %}

    {% endfor %}

  </div>
</section>

<style type="text/css">
  .fa-play-circle {
    position:absolute;
    width:40px;
    height:40px;
    margin:auto;
    top:0;
    right:0;
    bottom:0;
    left:0;
    font-size:40px;
    color:#E1E1E1;
    opacity:0.7;
    z-index:999;
  }
</style>